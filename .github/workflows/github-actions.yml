name: 'test'

on:
  push:
    branches: [ 'actions-migration' ]

jobs:
  test:
    runs-on: ubuntu-latest
    env:
      SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
      BUILD_DIR: build
      DIST_DIR_S3: dist/s3
      DIST_DIR_GITHUB: dist/github
      GITHUB_RELEASE_FILENAME: contacts-bmlt.zip
      PLUGIN: "contacts-bmlt"
      MAINFILE: "contacts-bmlt.php"
    steps:
      - name: Check out code
        uses: actions/checkout@v2

      - name: lint
        run: |
          composer install
          find . -name "*.php" ! -path '*/vendor/*' -print0 | xargs -0 -n1 -P8 php -l
          vendor/squizlabs/php_codesniffer/bin/phpcs --warning-severity=6 --standard=PSR2 --ignore=*/vendor/* --extensions=php --report=summary ./
